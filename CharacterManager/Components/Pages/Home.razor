@page "/"
@layout CharacterManager.Components.Layout.MainLayout

@using CharacterManager.Server.Constants
@using CharacterManager.Server.Services

@attribute [Microsoft.AspNetCore.Authorization.Authorize]
@inject AppVersionService VersionService
@inject ClientLocalizationService LocalizationService

<PageTitle>
    <LocalizedText Key="navigation.home" />
</PageTitle>

<link rel="stylesheet" href="/css/Home.css" />

<div class="home-container">

    @if (showPmlImportAlert)
    {
        <div class="alert alert-warning mt-4" role="alert">
            <h4 class="alert-heading">Initialisation requise</h4>
            @if (!string.IsNullOrEmpty(importError))
            {
                <p>@importError</p>
            }
            else
            {
                <p>La base de données est vide. Veuillez <a href="/import-export-pml">importer un fichier PML</a> pour
                    initialiser l'application.</p>
                <a class="btn btn-primary" href="/import-export-pml">Importer un fichier PML</a>
            }
        </div>
    }

    <div class="hub-container">

        <div class="hub-header">
            <h1 tabindex="-1" >Character Manager</h1>
            <p>
                <LocalizedText Key="home.welcome" />
            </p>
        </div>

        <div class="hub-grid">

            <div class="hub-card" @onclick="@(() => GoTo("escouade"))">
                <i class="hub-icon bi bi-people-fill"></i>

                <span class="msr hub-icon">groups</span>
                <h3>
                    <LocalizedText Key="navigation.squad" />
                </h3>
                <p>
                    <LocalizedText Key="home.squad" />
                </p>

                <div class="hub-metric">
                    <div class="metric-icon">
                        <i class="bi bi-lightning-charge-fill"></i>
                    </div>
                    <div class="metric-text">
                        <span class="metric-label">Puissance</span>
                        <span class="metric-value">@puissanceEscouade</span>
                    </div>
                </div>
            </div>

            <div class="hub-card" @onclick="@(() => GoTo(url: "meilleur-escouade"))">
                <span class="msr hub-icon">military_tech</span>
                <h3>
                    <LocalizedText Key="navigation.bestSquad" />
                </h3>
                <p>
                    <LocalizedText Key="home.bestSquad" />
                </p>

                <div class="hub-metric">
                    <div class="metric-icon">
                        <i class="bi bi-lightning-charge-fill"></i>
                    </div>
                    <div class="metric-text">
                        <span class="metric-label">Puissance</span>
                        <span class="metric-value">@puissanceMeilleureEscouade</span>
                    </div>
                </div>                
            </div>

            <div class="hub-card" @onclick="@(() => GoTo(url: "inventaire"))">
                <span class="msr hub-icon">inventory_2</span>
                <h3>
                    <LocalizedText Key="navigation.inventory" />
                </h3>
                <p>
                    <LocalizedText Key="home.inventory" />
                </p>
            </div>

            <div class="hub-card" @onclick="@(() => GoTo(url: "templates"))">
                <span class="msr hub-icon">layers</span>
                <h3>
                    <LocalizedText Key="navigation.templates" />
                </h3>
                <p>
                    <LocalizedText Key="home.templates" />
                </p>
            </div>

            <div class="hub-card" @onclick="@(() => GoTo(url: "import-export-pml"))">
                <span class="msr hub-icon">sync_alt</span>
                <h3>
                    <LocalizedText Key="navigation.importExportPml" />
                </h3>
                <p>
                    <LocalizedText Key="home.pml" />
                </p>
            </div>

            <div class="hub-card" @onclick="@(() => GoTo(url: "historique"))">
                <span class="msr hub-icon">history</span>
                <h3>
                    <LocalizedText Key="navigation.history" />
                </h3>
                <p>
                    <LocalizedText Key="home.history" />
                </p>
            </div>

            <div class="hub-card" @onclick="@(() => GoTo(url: "maison-lucie"))">
                <span class="msr hub-icon">home</span>
                <h3>
                    <LocalizedText Key="home.lucieLabel" />
                </h3>
                <p>
                    <LocalizedText Key="home.lucie" />
                </p>
                <div class="hub-metric">
                    <div class="metric-icon">
                        <i class="bi bi-lightning-charge-fill"></i>
                    </div>
                    <div class="metric-text">
                        <span class="metric-label">Puissance</span>
                        <span class="metric-value">@puissanceLucieEscouade</span>
                    </div>
                </div>   
            </div>

            <div class="hub-card" @onclick="@(() => GoTo(url: "classements"))">
                <span class="msr hub-icon">leaderboard</span>
                <h3>
                    <LocalizedText Key="navigation.rankings" />
                </h3>
                <p>
                    <LocalizedText Key="home.history" />
                </p>
            </div>

        </div>

    </div>

</div>

@code {
    [Inject] NavigationManager Nav { get; set; } = default!;

    void GoTo(string url)
    => Nav.NavigateTo(url);
}