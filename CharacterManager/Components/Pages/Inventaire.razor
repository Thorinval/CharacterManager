@page "/inventaire"
@layout CharacterManager.Components.Layout.MainLayout

@using CharacterManager.Server.Constants
@attribute [Microsoft.AspNetCore.Authorization.Authorize]
@using CharacterManager.Server.Models
@using CharacterManager.Server.Services
@using Microsoft.AspNetCore.Components.Web
@using CharacterManager.Components
@inject ClientLocalizationService LocalizationService

<link rel="stylesheet" href="/css/Inventaire.css" />

<head>
    <title>
        <LocalizedText Key="inventory.title" />
    </title>
</head>

<Toast @ref="toastRef" />

<!-- Section Template Preview -->
@if (showTemplateEditor)
{
    <div class="template-editor-wrapper">
        <div class="template-editor-section">
            <EscouadePreviewEditor PersonnagesSelectionnes="@templatePersonnages"
                OnSelectionChanged="@HandleTemplateSelectionChanged" OnPersonnageRequested="@GetPersonnageById"
                DraggedPersonnageId="@currentlyDraggedId" OnInvalidDrop="@HandleInvalidDrop" />

            <div class="template-actions mt-2">
                <div style="display: flex; flex-direction: column; gap: 8px;">
                    <div class="input-group">
                        <input id="templateNomInput" type="text" class="form-control"
                            style="font-size: 0.85rem; padding: 0.4rem 0.6rem;" placeholder="Nom du template"
                            @bind="templateNom" />
                        <input id="templateDescriptionInput" type="text" class="form-control"
                            style="font-size: 0.85rem; padding: 0.4rem 0.6rem;" placeholder="Description (optionnel)"
                            @bind="templateDescription" />
                    </div>
                    <div class="input-group">
                        <select id="templateSelect" class="form-select" style="font-size: 0.85rem; padding: 0.4rem 0.6rem;"
                            @bind="selectedTemplateId">
                            <option value="0">Charger template</option>
                            @foreach (var t in templates)
                            {
                                <option value="@t.Id">@t.Nom</option>
                            }
                        </select>
                        <button class="btn btn-outline-primary btn-sm" style="font-size: 0.75rem;"
                            @onclick="LoadSelectedTemplate" disabled="@(selectedTemplateId == 0)">
                            <i class="bi bi-upload"></i>
                        </button>
                    </div>
                    <div class="input-group" style="gap: 4px;">
                        <button class="btn btn-success btn-sm" style="flex: 1; font-size: 0.75rem;" @onclick="SaveTemplate"
                            disabled="@(string.IsNullOrEmpty(templateNom) || templateSelectedIds.Count == 0)">
                            <i class="bi bi-check-circle"></i> Créer
                        </button>
                        <button class="btn btn-secondary btn-sm" style="flex: 1; font-size: 0.75rem;"
                            @onclick="() => CancelTemplateCreation()">
                            <i class="bi bi-x"></i> Annuler
                        </button>
                        <button class="btn btn-info btn-sm" style="flex: 1; font-size: 0.75rem;"
                            @onclick="ExportTemplateAsPml">
                            <i class="bi bi-download"></i>
                        </button>
                    </div>
                </div>
            </div>
        </div>

        <div class="template-inventory-panel">
            <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 8px;">
                <h6 style="margin: 0; font-size: 0.9rem;">Inventaire</h6>
                <button class="btn btn-sm btn-outline-secondary" @onclick="() => showTemplateEditor = false"
                    title="Fermer l'éditeur" style="padding: 0.2rem 0.4rem;">
                    <i class="bi bi-x"></i>
                </button>
            </div>
            <div class="input-group" style="margin-bottom: 8px;">
                <input id="searchInput" type="text" class="form-control" style="font-size: 0.85rem; padding: 0.4rem 0.6rem;"
                    placeholder="Rechercher..." @bind="searchTerm" @oninput="HandleSearchInput" />
                <button class="btn btn-outline-secondary btn-sm" type="button" @onclick="ClearSearch" title="Effacer">
                    <i class="bi bi-x-lg"></i>
                </button>
            </div>
            <div class="template-inventory-content">
                @if (personnagesFiltres.Any())
                {
                    <div class="template-inventory-grid-grouped">
                        @foreach (var groupe in GroupedPersonnages)
                        {
                            <div class="template-type-group-header">
                                <h6>@groupe.Key (@groupe.Count())</h6>
                            </div>
                            @foreach (var personnage in groupe)
                            {
                                <div class="personnage-card-grid-compact" @ondragstart="@(e => HandleDragStart(e, personnage))"
                                    draggable="true">
                                    <img src="@personnage.GetImageUrl(true)" alt="@personnage.Nom" class="personnage-card-image-compact"
                                        onerror="this.onerror=null; this.src='/api/resources/interface/default_portrait.png';" />
                                    <div class="card-overlay-compact">
                                        <span class="card-name-compact">@personnage.Nom</span>
                                        <span class="card-puissance-compact">@personnage.Puissance</span>
                                    </div>
                                </div>
                            }
                        }
                    </div>
                }
            </div>
        </div>
    </div>
}

@if (!showTemplateEditor)
{
    <div class="mb-3" style="padding-top: 1rem;">
        <div class="row g-3 align-items-center">
            <div class="col-lg-4 col-md-12">
                <div class="sort-controls d-flex flex-wrap align-items-center gap-2">
                    <span class="me-1">
                        <LocalizedText Key="inventory.sort" />
                    </span>
                    <button class="btn btn-sm btn-outline-secondary" @onclick="SortByPuissance">
                        <LocalizedText Key="inventory.power" />
                    </button>
                    <button class="btn btn-sm btn-outline-secondary" @onclick="SortByNom">
                        <LocalizedText Key="inventory.name" />
                    </button>
                    <button class="btn btn-sm btn-outline-secondary" @onclick="SortByRarete">
                        <LocalizedText Key="inventory.rarity" />
                    </button>
                    <button class="btn btn-sm btn-outline-secondary" @onclick="SortByNiveau">
                        <LocalizedText Key="inventory.level" />
                    </button>
                    <button class="btn btn-sm btn-outline-secondary" @onclick="SortByRang">
                        <LocalizedText Key="inventory.rank" />
                    </button>
                </div>
            </div>

            <div class="col-lg-4 col-md-6">
                <div class="input-group">
                    <input id="searchInput" type="text" class="form-control"
                        placeholder="@LocalizationService.T("inventory.searchPlaceholder")" @bind="searchTerm"
                        @oninput="HandleSearchInput" />
                    <button class="btn btn-outline-secondary" type="button" @onclick="ClearSearch"
                        title="@LocalizationService.T("inventory.clearSearch")">
                        <i class="bi bi-x-lg"></i>
                    </button>
                </div>
            </div>

            <div class="col-lg-4 col-md-6">
                <div class="d-flex justify-content-end align-items-center flex-wrap gap-2">
                    @if (selectedPersonnages.Any())
                    {
                        <button class="btn btn-warning" @onclick="ShowBulkEditModal">
                            <LocalizedText Key="inventory.bulkEdit" /> (@selectedPersonnages.Count)
                        </button>
                    }
                    <button class="btn btn-primary"
                        @onclick="() => { isEditing = false; currentPersonnage = new Personnage(); showModal = true; }">
                        <LocalizedText Key="inventory.add" />
                    </button>
                    <button class="btn btn-info" @onclick="() => OpenTemplateEditor()"
                        title="Créer un template d'escouade">
                        <i class="bi bi-plus-circle"></i>
                        <LocalizedText Key="inventory.template" />
                    </button>
                    <button class="btn btn-success" @onclick="ExportToPML" title="Exporter l'inventaire">
                        <i class="bi bi-download"></i>
                        <LocalizedText Key="inventory.export" />
                    </button>
                    <button class="btn btn-danger" @onclick="DeleteSelectedPersonnages"
                        disabled="@(!selectedPersonnages.Any())" title="Supprimer les personnages sélectionnés">
                        <i class="bi bi-trash-fill"></i>
                        <LocalizedText Key="inventory.bulkDelete" /> (@selectedPersonnages.Count)
                    </button>
                    <button class="btn btn-danger" @onclick="ResetAll" title="Supprimer les données">
                        <i class="bi bi-trash-fill"></i>
                        <LocalizedText Key="inventory.deleteAll" />
                    </button>
                </div>
            </div>
        </div>

        <div class="d-flex justify-content-end align-items-center gap-2 view-mode-controls mt-2">
            <button class="btn btn-sm @GetViewModeClass(AppConstants.Defaults.ViewModeGrid)"
                @onclick="@(() => viewMode = AppConstants.Defaults.ViewModeGrid)"
                title="@LocalizationService.T("inventory.grid")">
                <i class="bi bi-grid-3x3-gap"></i>
                <LocalizedText Key="inventory.grid" />
            </button>
            <button class="btn btn-sm @GetViewModeClass(AppConstants.Defaults.ViewModeList)"
                @onclick="@(() => viewMode = AppConstants.Defaults.ViewModeList)"
                title="@LocalizationService.T("inventory.list")">
                <i class="bi bi-list-ul"></i>
                <LocalizedText Key="inventory.list" />
            </button>
        </div>
    </div>

    <div class="select-all-container mb-3">
        <input type="checkbox" id="selectAll" checked="@SelectAllChecked" @onchange="SelectAll" />
        <label for="selectAll" class="ms-2">
            <LocalizedText Key="inventory.selectAll" />
        </label>
    </div>

    <ul class="nav nav-pills mb-3">

        @foreach (var option in FilterOptions)
        {
            var count = GetCount(option.Value);
            var colorClass = GetBadgeColor(option.Value);

            <li class="nav-item">
                <button
                    class="nav-link d-flex align-items-center
                                                                           @(SelectedFilter == option.Value ? "active glow-active" : "")"
                    @onclick="() => OnFilterClicked(option.Value)">

                    <span class="me-2">
                        <LocalizedText Key="@option.LocalizationKey" />
                    </span>

                    <span class="badge @colorClass">
                        @count
                    </span>

                </button>
            </li>
        }

    </ul>

    @if (personnagesFiltres.Any())
    {
        @foreach (var groupe in GroupedPersonnages)
        {
            <div class="type-group-header">
                <h4>@groupe.Key (@groupe.Count())</h4>
            </div>

            <div class="@GetContainerClass()">
                @foreach (var personnage in groupe)
                {
                    @if (viewMode == AppConstants.Defaults.ViewModeGrid)
                    {
                        <div class="personnage-card-editable @GetRarityClass(personnage.Rarete)" draggable="true"
                            @ondragstart="@(e => HandleDragStart(e, personnage))">
                            <div class="card-checkbox-grid" @onclick:stopPropagation="true">
                                <input id=@($"selInput_p{personnage.Id}") type="checkbox"
                                    checked="@selectedPersonnages.Contains(personnage.Id)"
                                    @onchange="() => ToggleSelection(personnage.Id)" />
                            </div>

                            <div class="card-name-header">
                                <div class="personnage-name-top">@personnage.Nom</div>
                                <div class="card-rarity-text rarity-text-@personnage.Rarete.ToString().ToLower()">@personnage.Rarete</div>
                            </div>

                            <img src="@personnage.GetImageUrl(true)" alt="@personnage.Nom" class="personnage-card-image-editable"
                                @onclick="() => ViewPersonnage(personnage.Id)" style="cursor: pointer;"
                                onerror="this.onerror=null; this.src='/api/resources/interface/default_portrait.png';" />
                            <div class="personnage-card-info">
                                <div class="editable-field">
                                    <label for=@( $"niveauInput_p{personnage.Id}")>
                                        <LocalizedText Key="inventory.level" />:
                                    </label>
                                    <input id=@($"niveauInput_p{personnage.Id}") type="number" min="1" max="200"
                                        class="form-control form-control-sm" value="@personnage.Niveau"
                                        @onchange="@((ChangeEventArgs e) => UpdatePersonnageField(personnage.Id, "Niveau", e.Value?.ToString() ?? "1"))"
                                        @onclick:stopPropagation="true" />
                                </div>
                                <div class="editable-field">
                                    <label for=@($"selectionneInput_p{personnage.Id}")>
                                        <LocalizedText Key="inventory.selected" />
                                    </label>
                                    <InputCheckbox id=@($"selectionneInput_p{personnage.Id}") Value="@personnage.Selectionne"
                                        ValueChanged="@( (bool value) => OnSelectionneChanged(personnage.Id, value) )"
                                        ValueExpression="@(() => personnage.Selectionne)" @onclick:stopPropagation="true" />
                                </div>

                                @if (personnage.Type != TypePersonnage.Androide)
                                {
                                    <div class="editable-field">
                                        <span>
                                            <LocalizedText Key="inventory.rank" />:
                                        </span>
                                        <div class="star-selector" @onclick:stopPropagation="true">
                                            @for (int i = 1; i <= 7; i++)
                                            {
                                                var starIndex = i;
                                                <span class="star-interactive @(starIndex <= personnage.Rang ? "filled" : "empty")"
                                                    @onclick="() => UpdateRankFromStar(personnage.Id, starIndex, personnage.Rang)">
                                                    @(starIndex <= personnage.Rang ? "★" : "☆")
                                                </span>
                                            }
                                        </div>
                                    </div>
                                }

                                <div class="editable-field">
                                    <label for=@($"puissanceInput_p{personnage.Id}")>
                                        <LocalizedText Key="inventory.power" />:
                                    </label>
                                    <div class="input-group input-group-sm">
                                        <button class="btn btn-outline-secondary" type="button"
                                            @onclick="() => ChangePuissance(personnage.Id, -5)" @onclick:stopPropagation="true">-</button>
                                        <input id=@($"puissanceInput_p{personnage.Id}") type="number" min="0"
                                            class="form-control form-control-sm text-center" value="@personnage.Puissance"
                                            @onchange="@((ChangeEventArgs e) => UpdatePersonnageField(personnage.Id, "Puissance", e.Value?.ToString() ?? "0"))"
                                            @onclick:stopPropagation="true" />
                                        <button class="btn btn-outline-secondary" type="button"
                                            @onclick="() => ChangePuissance(personnage.Id, 5)" @onclick:stopPropagation="true">+</button>
                                    </div>
                                </div>

                                <div class="card-actions-editable" @onclick:stopPropagation="true">
                                    <button class="btn btn-sm btn-warning" @onclick="() => EditPersonnage(personnage)"
                                        title="@LocalizationService.T("inventory.edit")">
                                        <i class="bi bi-pencil"></i>
                                        <LocalizedText Key="inventory.edit" />
                                    </button>
                                    <button class="btn btn-sm btn-danger" @onclick="() => DeletePersonnage(personnage.Id)"
                                        title="@LocalizationService.T("inventory.delete")">
                                        <i class="bi bi-trash"></i>
                                        <LocalizedText Key="inventory.delete" />
                                    </button>
                                </div>
                            </div>
                        </div>
                    }
                    else
                    {
                        <div class="personnage-card-list" @onclick="() => ViewPersonnage(personnage.Id)" style="cursor: pointer;"
                            draggable="true" @ondragstart="@(e => HandleDragStart(e, personnage))">
                            <div class="card-checkbox" @onclick:stopPropagation="true">
                                <input type="checkbox" checked="@selectedPersonnages.Contains(personnage.Id)"
                                    @onchange="() => ToggleSelection(personnage.Id)" />
                            </div>
                            <img src="@personnage.GetImageUrl(true)" alt="@personnage.Nom" class="personnage-card-image-list"
                                onerror="this.onerror=null; this.src='/api/resources/interface/default_portrait.png';" />
                            <div class="personnage-info-list">
                                <span class="personnage-name" style="font-weight: 700;">@personnage.Nom</span>
                                <span class="list-separator">|</span>
                                <span>Type: @personnage.Type</span>
                                <span class="list-separator">|</span>
                                <span>Rareté: @personnage.Rarete</span>
                                <span class="list-separator">|</span>
                                <span>Puissance: @personnage.Puissance</span>
                                <span class="list-separator">|</span>
                                <span>Niveau: @personnage.Niveau</span>
                                <span class="list-separator">|</span>
                                <span>Rang: @GetRankStars(personnage.Rang)</span>
                            </div>
                            <div class="card-actions-list" @onclick:stopPropagation="true">
                                <button class="btn btn-sm btn-warning" @onclick="() => EditPersonnage(personnage)">
                                    <LocalizedText Key="inventory.edit" />
                                </button>
                                <button class="btn btn-sm btn-danger" @onclick="() => DeletePersonnage(personnage.Id)">
                                    <LocalizedText Key="inventory.delete" />
                                </button>
                            </div>
                        </div>
                    }
                }
            </div>
        }
    }
    <!-- Section Maison de Lucie -->
    @if (lucieHouse != null && luciePiecesFiltres.Count > 0)
    {
        <div class="type-group-header mt-4">
            <h4>Maison de Lucie (@lucieHouse.Pieces.Count) -
                @lucieHouse.NombrePiecesSelectionnees/@LucieHouse.MaxPiecesSelectionnees sélectionnées</h4>
        </div>

        <div class="@GetContainerClass()">
            @foreach (var piece in lucieHouse.Pieces)
            {
                <div class="personnage-card-editable @(piece.Selectionnee ? "piece-selectionnee" : "piece-non-selectionnee")">
                    <div class="card-checkbox-grid" @onclick:stopPropagation="true">
                        <input id=@($"selectionneeInput_l{piece.Id}") type="checkbox" checked="@piece.Selectionnee"
                            @onchange="() => TogglePieceSelection(piece.Id)"
                            disabled="@(!piece.Selectionnee && !lucieHouse.PeutSelectionner())" />
                    </div>

                    <div class="card-name-header">
                        <div class="personnage-name-top">@piece.Nom</div>
                        <div class="card-rarity-text">Niveau @piece.Niveau</div>
                    </div>

                    <div class="personnage-card-info">
                        <div class="editable-field">
                            <label for=@($"niveauInput_l{piece.Id}")>Niveau:</label>
                            <div class="input-group input-group-sm">
                                <button class="btn btn-outline-secondary" type="button"
                                    @onclick="() => ChangeNiveauPiece(piece.Id, -1)" @onclick:stopPropagation="true">-</button>
                                <input id=@($"niveauInput_l{piece.Id}") type="number" min="1"
                                    class="form-control form-control-sm text-center" value="@piece.Niveau"
                                    @onchange="@((ChangeEventArgs e) => UpdatePieceField(piece.Id, "Niveau", e.Value?.ToString() ?? "0"))"
                                    @onclick:stopPropagation="true" />
                                <button class="btn btn-outline-secondary" type="button"
                                    @onclick="() => ChangeNiveauPiece(piece.Id, 1)" @onclick:stopPropagation="true">+</button>
                            </div>
                        </div>

                        <div class="editable-field">
                            <span>Puissance:</span>
                            <div class="form-control form-control-sm" style="font-weight:600;">
                                @piece.PuissanceTotale
                            </div>
                        </div>

                        <div class="editable-field">
                            <label for=@($"aspectsTactiquesInput_l{piece.Id}")>Aspects tactiques:</label>
                            <div class="input-group input-group-sm">
                                <button class="btn btn-outline-secondary" type="button"
                                    @onclick="() => ChangePuissancePiece(piece.Id, TypeBonus.Tactique, -5)"
                                    @onclick:stopPropagation="true">-</button>
                                <input id=@($"aspectsTactiquesInput_l{piece.Id}") type="number" min="0"
                                    class="form-control form-control-sm text-center" value="@piece.AspectsTactiques.Puissance"
                                    @onchange="@((ChangeEventArgs e) => UpdatePieceField(piece.Id, "PuissanceTactique", e.Value?.ToString() ?? "0"))"
                                    @onclick:stopPropagation="true" />
                                <button class="btn btn-outline-secondary" type="button"
                                    @onclick="() => ChangePuissancePiece(piece.Id, TypeBonus.Tactique, 5)"
                                    @onclick:stopPropagation="true">+</button>
                            </div>
                        </div>

                        <div class="editable-field">
                            <label for=@($"aspectsStrategiquesInput_l{piece.Id}")>Aspects stratégiques:</label>
                            <div class="input-group input-group-sm">
                                <button class="btn btn-outline-secondary" type="button"
                                    @onclick="() => ChangePuissancePiece(piece.Id, TypeBonus.Strategique, -5)"
                                    @onclick:stopPropagation="true">-</button>
                                <input id=@($"aspectsStrategiquesInput_l{piece.Id}") type="number" min="0"
                                    class="form-control form-control-sm text-center" value="@piece.AspectsStrategiques.Puissance"
                                    @onchange="@((ChangeEventArgs e) => UpdatePieceField(piece.Id, "PuissanceStrategique", e.Value?.ToString() ?? "0"))"
                                    @onclick:stopPropagation="true" />
                                <button class="btn btn-outline-secondary" type="button"
                                    @onclick="() => ChangePuissancePiece(piece.Id, TypeBonus.Strategique, 5)"
                                    @onclick:stopPropagation="true">+</button>
                            </div>
                        </div>
                    </div>
                </div>
            }
        </div>
    }


    @if (personnagesFiltres.Count == 0 && lucieHouse == null)
    {
        <p>
            <LocalizedText Key="inventory.empty" />
        </p>
    }
}

@if (showModal)
{
    <div class="modal-overlay" @onclick:stopPropagation="true">
        <div class="modal-dialog-custom" @onclick:stopPropagation="true">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title">@(isEditing ? "Éditer Personnage" : "Ajouter Personnage")</h5>
                    <button type="button" class="btn-close" @onclick="CloseModal"></button>
                </div>
                <div class="modal-body">
                    <div class="mb-3">
                        <label for="nom" class="form-label">Nom</label>
                        <input type="text" class="form-control" id="nom" @bind="currentPersonnage.Nom" />
                    </div>
                    <div class="mb-3">
                        <label for="rarete" class="form-label">Rareté</label>
                        <select class="form-control" id="rarete" @bind="currentPersonnage.Rarete">
                            @foreach (var rarete in Enum.GetValues(typeof(Rarete)))
                            {
                                <option value="@rarete">@rarete</option>
                            }
                        </select>
                    </div>
                    <div class="mb-3">
                        <label for="type" class="form-label">Type</label>
                        <select class="form-control" id="type" @bind="currentPersonnage.Type">
                            @foreach (var type in Enum.GetValues(typeof(TypePersonnage)))
                            {
                                <option value="@type">@type</option>
                            }
                        </select>
                    </div>
                    <div class="mb-3">
                        <label for="niveau" class="form-label">Niveau</label>
                        <input type="number" class="form-control" id="niveau" @bind="currentPersonnage.Niveau" min="1"
                            max="200" />
                    </div>
                    <div class="mb-3">
                        <label for="rang" class="form-label">Rang</label>
                        <input type="number" class="form-control" id="rang" @bind="currentPersonnage.Rang" min="0"
                            max="7" />
                    </div>
                    <div class="mb-3">
                        <label for="puissance" class="form-label">Puissance</label>
                        <input type="number" class="form-control" id="puissance" @bind="currentPersonnage.Puissance"
                            min="0" />
                    </div>
                    <div class="mb-3">
                        <label for="action" class="form-label">Type d'attaque</label>
                        <select class="form-control" id="action" @bind="currentPersonnage.TypeAttaque">
                            <option value="">Sélectionner un type d'attaque</option>
                            <option value="Melee">Mêlée</option>
                            <option value="Distance">Distance</option>
                            <option value="Androide">Androïde</option>
                            <option value="Commandant">Commandant</option>
                        </select>
                    </div>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" @onclick="CloseModal">Annuler</button>
                    <button type="button" class="btn btn-primary" @onclick="SavePersonnage">@(isEditing ? "Sauvegarder" :
                                            "Ajouter")</button>
                </div>
            </div>
        </div>
    </div>

}

@if (showBulkEditModal)
{
    <div class="modal fade show d-block" tabindex="-1" style="background-color: rgba(0,0,0,0.5);">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title">Modifier @selectedPersonnages.Count personnages</h5>
                    <button type="button" class="btn-close" @onclick="() => showBulkEditModal = false"></button>
                </div>
                <div class="modal-body">
                    <div class="mb-3">
                        <label class="form-label">Propriété à modifier</label>
                        <select class="form-select" @bind="bulkEditProperty">
                            <option value="">Sélectionner une propriété</option>
                            <option value="Niveau">Niveau</option>
                            <option value="TypeAttaque">Type d'attaque</option>
                            <option value="Selectionne">Sélection</option>
                        </select>
                    </div>
                    <div class="mb-3">
                        <label class="form-label">Nouvelle valeur</label>
                        @if (bulkEditProperty == "Niveau")
                        {
                            <input type="number" class="form-control" @bind="bulkEditValue" placeholder="Entrez le niveau" />
                        }
                        else if (bulkEditProperty == "TypeAttaque")
                        {
                            <select class="form-select" @bind="bulkEditValue">
                                <option value="">Sélectionner un type d'attaque</option>
                                <option value="Mêlée">Mêlée</option>
                                <option value="Distance">Distance</option>
                                <option value="Androïde">Androïde</option>
                            </select>
                        }
                        else if (bulkEditProperty == "Selectionne")
                        {
                            <select class="form-select" @bind="bulkEditValue">
                                <option value="">Sélectionner une valeur</option>
                                <option value="true">Sélectionné</option>
                                <option value="false">Non sélectionné</option>
                            </select>
                        }
                        else
                        {
                            <input type="text" class="form-control" @bind="bulkEditValue" placeholder="Entrez la valeur" />
                        }
                    </div>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary"
                        @onclick="() => showBulkEditModal = false">Annuler</button>
                    <button type="button" class="btn btn-primary" @onclick="ApplyBulkEdit"
                        disabled="@(string.IsNullOrEmpty(bulkEditProperty) || string.IsNullOrEmpty(bulkEditValue))">Appliquer</button>
                </div>
            </div>
        </div>
    </div>
}